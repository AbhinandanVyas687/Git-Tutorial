utility functions for version 3 Tue 30 08 2022